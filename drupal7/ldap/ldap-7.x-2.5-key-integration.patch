[1mdiff --git a/ldap_servers/LdapServer.class.php b/ldap_servers/LdapServer.class.php[m
[1mindex f8c9086..29715be 100644[m
[1m--- a/ldap_servers/LdapServer.class.php[m
[1m+++ b/ldap_servers/LdapServer.class.php[m
[36m@@ -426,6 +426,10 @@[m [mclass LdapServer {[m
       $userdn = ($userdn != NULL) ? $userdn : $this->binddn;[m
       $pass = ($pass != NULL) ? $pass : $this->bindpw;[m
 [m
[32m+[m[32m      if (module_exists('key') && $key_value = key_get_key_value($pass)) {[m
[32m+[m[32m        $pass = $key_value;[m
[32m+[m[32m      }[m
[32m+[m
       if ($this->followrefs) {[m
         $rebHandler = new LdapServersRebindHandler($userdn, $pass);[m
         ldap_set_rebind_proc($this->connection, [$rebHandler, 'rebind_callback']);[m
[1mdiff --git a/ldap_servers/LdapServerAdmin.class.php b/ldap_servers/LdapServerAdmin.class.php[m
[1mindex f0e1bf9..c198d6d 100644[m
[1m--- a/ldap_servers/LdapServerAdmin.class.php[m
[1m+++ b/ldap_servers/LdapServerAdmin.class.php[m
[36m@@ -750,6 +750,7 @@[m [mclass LdapServerAdmin extends LdapServer {[m
           '#type' => 'checkbox',[m
           '#title' => t('Clear existing password from database.  Check this when switching away from Service Account Binding.'),[m
           '#default_value' => 0,[m
[32m+[m[32m          '#access' => FALSE[m
         ],[m
       ],[m
 [m
[36m@@ -1243,6 +1244,11 @@[m [mclass LdapServerAdmin extends LdapServer {[m
 [m
     ];[m
 [m
[32m+[m[32m    if (array_key_exists('key_select', module_invoke_all('element_info'))) {[m
[32m+[m[32m      $fields['bindpw']['form']['#type'] = 'key_select';[m
[32m+[m[32m      unset($fields['bindpw']['form']['#size']);[m
[32m+[m[32m    }[m
[32m+[m
     return $fields;[m
 [m
   }[m
